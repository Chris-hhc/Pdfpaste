# PDF Paster

一个专为macOS设计的PDF页面批量处理工具，帮助用户快速选择PDF页面并批量复制粘贴到网页版AI聊天工具中，提升AI问答效率。

## 🎯 核心功能

### 📄 PDF页面批量选择
- 支持灵活的页码范围选择（如：`1,3,5-7,10`）
- 实时预览选中页面
- 多级缩放支持（50%-500%），方便查看细节

### ⚡ 一键批量复制粘贴
- **全局快捷键**：`Option + Command` 触发自动遍历
- **智能间隔**：可自定义每张图片复制间隔（0.5-60秒）
- **后台运行**：无需手动操作，自动完成所有页面的复制粘贴
- **高质量图片**：自动转换为高清PNG/TIFF格式

### 🤖 AI聊天优化
- 专为网页版AI工具（ChatGPT、Claude、文心一言等）设计
- 自动模拟粘贴操作，直接插入聊天框
- 支持大批量页面处理，一次性提交完整文档

### 🎨 现代化界面
- 直观的页面预览网格
- 实时显示选择状态
- 临时文件管理
- 进度指示器

## 🖥️ 系统要求

**⚠️ 仅支持 macOS 平台**

- macOS 10.14 或更高版本
- Python 3.7+
- 依赖库：PyQt5、PyMuPDF、AppKit

## 🚀 快速开始

### 安装依赖
```bash
pip install PyQt5 PyMuPDF pillow
```

### 运行程序
```bash
python main.py
```

## 📖 使用指南

### 基本工作流程

1. **打开PDF文档**
   - 点击"选择PDF文件"
   - 等待文档加载完成

2. **选择目标页面**
   - 在页码输入框输入范围：`1,3,5-7,10`
   - 点击"选择页面"
   - 在预览区域确认选中的页面

3. **保存为图片**
   - 点击"保存选中页面为图片"
   - 图片自动保存到临时目录

4. **批量复制粘贴**
   - 按下全局快捷键 `Option + Command`
   - 程序自动遍历所有图片，依次复制并粘贴
   - 可在任意应用中使用，无需切换窗口

### 页码输入格式

| 格式 | 说明 | 示例 |
|------|------|------|
| 单页 | 选择单个页面 | `5` |
| 多页 | 逗号分隔多个页面 | `1,3,7,12` |
| 范围 | 连字符表示连续页面 | `5-10` |
| 混合 | 组合使用 | `1,3,5-7,10,15-20` |

### 快捷键

| 快捷键 | 功能 | 作用范围 |
|--------|------|----------|
| `Command+O` | 打开PDF文件 | 应用内 |
| `Command+S` | 选择页面 | 应用内 |
| `Option+Command` | 批量复制粘贴 | **全局** |

### 时间间隔设置

- **默认间隔**：4秒
- **可调范围**：0.5-60秒
- **快捷设置**：1秒、3秒、6秒按钮
- **支持小数**：如2.5秒

## 🎯 AI聊天使用场景

### 学术研究
```
1. 选择论文关键页面（摘要、图表、结论）
2. 批量粘贴到ChatGPT
3. 询问："请分析这篇论文的主要观点和创新点"
```

### 文档分析
```
1. 选择合同/报告的重要条款页面
2. 一键粘贴到Claude
3. 询问："请帮我总结这些条款的要点和风险"
```

### 学习辅导
```
1. 选择教材的习题页面
2. 批量提交到AI工具
3. 询问："请解答这些题目并说明解题思路"
```

## 🔧 高级功能

### 缩放预览
- **基础控制**：+/- 按钮、重置按钮
- **快捷缩放**：50%、100%、150%、200%、300%、400%
- **智能步长**：根据当前缩放比例自动调整步长

### 临时文件管理
- 自动创建临时目录
- 实时显示文件列表
- 支持打开文件夹
- 程序退出时自动清理

## 📋 Todo List - 未来开发计划

### 🔥 高优先级

- [ ] **PDF缩放响应速度**
   - 支持高速响应

- [ ] **OCR文字提取功能**
  - 集成OCR引擎，提取PDF页面文字
  - 支持中英文混合识别
  - 文字+图片组合输出

- [ ] **批量文档处理**
  - 支持同时处理多个PDF文件
  - 文件夹批量导入
  - 批处理队列管理

- [ ] **智能页面识别**
  - 自动识别图表、表格页面
  - 智能推荐重要页面
  - 内容相似度分析

### 🚀 中优先级

- [ ] **导出格式扩展**
  - 支持导出为Word文档
  - 生成Markdown格式
  - PDF页面重组功能

- [ ] **AI集成优化**
  - 直接集成主流AI API
  - 自动生成提问模板
  - 对话历史管理

- [ ] **用户体验优化**
  - 拖拽选择页面
  - 键盘快捷导航
  - 主题切换功能

### 💡 低优先级

- [ ] **云端同步**
  - 设置云端备份
  - 多设备同步
  - 历史记录保存

- [ ] **插件系统**
  - 支持第三方插件
  - 自定义处理流程
  - 脚本自动化

- [ ] **性能优化**
  - 大文件处理优化
  - 内存使用优化
  - 多线程渲染

## ⚠️ 注意事项

- **平台限制**：仅支持macOS系统，使用了macOS原生的剪贴板和快捷键API
- **权限要求**：首次使用可能需要授权辅助功能权限
- **内存使用**：处理大型PDF文件时会占用较多内存
- **网络要求**：批量粘贴功能需要目标应用支持图片粘贴

## 🐛 故障排除

### 常见问题

**Q: 全局快捷键不响应**
```
A: 检查系统偏好设置 → 安全性与隐私 → 辅助功能
   确保应用已获得权限
```

**Q: 程序崩溃**
```
A: 检查PDF文件是否损坏
   重启程序重试
```

## 📄 许可证

MIT License - 可自由使用、修改和分发

## 🤝 贡献

欢迎提交Issue和Pull Request，共同改进这个工具！

---

**让AI问答更高效，让知识获取更便捷！** 🚀 